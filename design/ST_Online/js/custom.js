function ajax_set_result(e){$("#cart_informer").html(e.cart_informer),$("#fn_purchases").html(e.cart_purchases),$("#fn_ajax_deliveries").html(e.cart_deliveries)}function ajax_change_amount(e,t){var a=$(e).val(),s=$('input[name="coupon_code"]').val(),i=$('input[name="delivery_id"]:checked').val(),n=$('input[name="payment_method_id"]:checked').val();$.ajax({url:"ajax/cart_ajax.php",data:{coupon_code:s,action:"update_citem",variant_id:t,amount:a},dataType:"json",success:function(e){1==e.result?(ajax_set_result(e),$("#deliveries_"+i).trigger("click"),$("#payment_"+i+"_"+n).trigger("click")):($("#cart_informer").html(e.cart_informer),$(".fn_ajax_content").html(e.content))}})}function amount_change(e,t){var a,s=parseFloat(e.val()),i=1,n=e.data("id");isNaN(s)&&(s=okay.amount),a=e.parent().hasClass("fn_is_preorder")?50:parseFloat(e.data("max")),"plus"==t?(e.val(Math.min(a,Math.max(1,s+i))),e.trigger("change")):"minus"==t?(e.val(Math.min(a,Math.max(1,s-i))),e.trigger("change")):"keyup"==t&&(e.val(Math.min(a,Math.max(1,s))),e.trigger("change")),okay.amount=parseInt(e.val()),$("div").is("#fn_purchases")&&(a!=s&&"plus"==t||1!=s&&"minus"==t)&&ajax_change_amount(e,n)}function transfer(e,t){var a=t.offset(),s=e.offset(),i=a.left-s.left,n=a.top-s.top,o=Math.sqrt(i*i+n*n);t.closest(".fn_transfer").find(".fn_img").effect("transfer",{to:e,className:"transfer_class"},o);var r=$(".transfer_class");r.html(t.closest(".fn_transfer").find(".fn_img").parent().html()),r.find("*").css("display","none"),r.find(".fn_img").css({display:"block",height:"100%","z-index":"666",position:"relative"})}function ajax_coupon(){var e=$('input[name="coupon_code"]').val(),t=$('input[name="delivery_id"]:checked').val(),a=$('input[name="payment_method_id"]:checked').val();$.ajax({url:"ajax/cart_ajax.php",data:{coupon_code:e,action:"coupon_apply"},dataType:"json",success:function(e){1==e.result?(ajax_set_result(e),$("#deliveries_"+t).trigger("click"),$("#payment_"+t+"_"+a).trigger("click")):($("#cart_informer").html(e.cart_informer),$(".fn_ajax_content").html(e.content))}})}function change_payment_method(e){$("#fn_delivery_payment_"+e+" [name='payment_method_id']").first().trigger("click"),$(".fn_delivery_payment").hide(),$("#fn_delivery_payment_"+e).show(),$('input[name="delivery_id"]').parent().removeClass("active"),$("#deliveries_"+e).parent().addClass("active"),$('.delivery_item [class*="d_"]').slideUp(333),$(".delivery_item .d_"+e).slideDown(555)}function payment_click(e){$('.delivery_item [class*="p_"]').slideUp(333),$(".delivery_item .p_"+e).slideDown(555)}function ajax_remove(e){var t=$('input[name="coupon_code"]').val(),a=$('input[name="delivery_id"]:checked').val(),s=$('input[name="payment_method_id"]:checked').val();$.ajax({url:"ajax/cart_ajax.php",data:{coupon_code:t,action:"remove_citem",variant_id:e},dataType:"json",success:function(e){1==e.result?(ajax_set_result(e),$("#deliveries_"+a).trigger("click"),$("#payment_"+a+"_"+s).trigger("click")):($("#cart_informer").html(e.cart_informer),$(".fn_ajax_content").html(e.content))}})}function resize_comparison(){var e=0;$(".fn_resize").each(function(){$(this).height()>e&&(e=$(this).height())}),$(".fn_resize").height(e),$("[data-use]").size()&&$("[data-use]").each(function(){var e="."+$(this).data("use"),t=$(this).height();$(e).size()&&($(e).each(function(){$(this).height()>=t&&(t=$(this).height())}),$(e).height(t))})}okay.amount=1,$(window).load(function(){}),$(function(){$('a[href^="#"], .inpage-scroll a[href^="#"]').on("click",function(e){e.preventDefault();var t=this.hash,a=$(t);$("html, body").stop().animate({scrollTop:a.offset()?a.offset().top:0},900,"swing",function(){window.location.hash=t})}),$(".readmore_js").readmore({speed:330,collapsedHeight:270,heightMargin:16,moreLink:'<a href="#">Развернуть</a>',lessLink:'<a href="#">Свернуть</a>',embedCSS:!1,startOpen:!1,afterToggle:function(e,t,a){a||$("html, body").animate({scrollTop:t.offset().top-30},{duration:200})}}),$(window).scroll(function(){$(this).scrollTop()<3*$("header").height()?$(".scroll_top").removeClass("active"):$(".scroll_top").addClass("active")}),$(".fn_callback").fancybox(),$(".drop_btn").click(function(){$(this).parent().toggleClass("active"),$(this).next().slideToggle(222)}),$(".drop_block").mouseleave(function(){$(this).removeClass("active"),$(this).find("> .drop_list").fadeOut(111)}),$(".fn_switch").click(function(e){e.preventDefault(),$(this).next().slideToggle(300),$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")}),$(".subswitch").click(function(){$(this).parent().next().slideToggle(500),$(this).hasClass("down")?$(this).removeClass("down"):$(this).addClass("down")}),$(".catalog_menu .selected").parents(".parent").addClass("opened").find("> .switch").addClass("active");var e=$(".tabs").find(".tab_navigation"),t=$(".tabs").find(".tab_container");if(e.children(".selected").size()>0?$(e.children(".selected").attr("href")).show():(e.children().first().addClass("selected"),t.children().first().show()),$(".tab_navigation a").click(function(a){return a.preventDefault(),$(this).hasClass("selected")?!0:(t.children().hide(),e.children().removeClass("selected"),$(this).addClass("selected"),void $($(this).attr("href")).fadeIn(200))}),$("#banner_1_bg100vw").slick({infinite:!0,speed:700,slidesToShow:1,slidesToScroll:1,swipeToSlide:!0,dots:!1,arrows:!0,adaptiveHeight:!1,autoplay:!0,autoplaySpeed:5e3,fade:!0}),$(".slick-products").slick({infinite:!1,speed:900,autoplay:!1,autoplaySpeed:6666,slidesToShow:5,slidesToScroll:2,dots:!1,arrows:!0,responsive:[{breakpoint:1320,settings:{slidesToShow:4,slidesToScroll:2}},{breakpoint:1100,settings:{slidesToShow:3,slidesToScroll:2}},{breakpoint:990,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:530,settings:{slidesToShow:1,slidesToScroll:1}}]}),$("#browsed_product .items-list").slick({infinite:!0,speed:900,autoplay:!0,autoplaySpeed:6666,slidesToShow:5,slidesToScroll:2,dots:!1,arrows:!0,responsive:[{breakpoint:1300,settings:{slidesToShow:4,slidesToScroll:2}},{breakpoint:1020,settings:{slidesToShow:3,slidesToScroll:2}},{breakpoint:766,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:540,settings:{slidesToShow:1,slidesToScroll:1}}]}),$(".fn_subcats").slick({infinite:!1,speed:500,slidesToShow:8,slidesToScroll:4,dots:!1,arrows:!0,responsive:[{breakpoint:1240,settings:{slidesToShow:7,slidesToScroll:4}},{breakpoint:1150,settings:{slidesToShow:6,slidesToScroll:3}},{breakpoint:990,settings:{slidesToShow:4,slidesToScroll:2}},{breakpoint:770,settings:{slidesToShow:3,slidesToScroll:2}},{breakpoint:460,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:320,settings:{slidesToShow:1,slidesToScroll:1}}]}),$(".fn_all_brands").slick({infinite:!0,speed:500,autoplay:!0,slidesToShow:6,slidesToScroll:5,dots:!0,arrows:!1,responsive:[{breakpoint:1390,settings:{slidesToShow:5,slidesToScroll:4}},{breakpoint:1180,settings:{slidesToShow:4,slidesToScroll:3}},{breakpoint:850,settings:{slidesToShow:3,slidesToScroll:2}},{breakpoint:630,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:400,settings:{slidesToShow:2,slidesToScroll:1}}]}),$("[data-fancybox]").fancybox({image:{protect:!0}}),$("#fn_slider_price").size()){var a=$("#fn_slider_min, #fn_slider_max"),s=$("#fn_slider_min"),i=$("#fn_slider_max"),n=s.val(),o=i.val(),r=s.data("price"),l=i.data("price"),d=window.location.href.replace(/\/page-(\d{1,5})/,""),c=function(){$.ajax({url:d,data:{ajax:1,"p[min]":s.val(),"p[max]":i.val()},dataType:"json",success:function(e){$("#fn_products_content").html(e.products_content),$(".fn_pagination").html(e.products_pagination),$(".fn_products_sort").html(e.products_sort),$(".fn_ajax_wait").remove()}})};d=d.replace(/\/sort-([a-zA-Z_]+)/,""),$("#fn_slider_price").slider({range:!0,min:r,max:l,values:[n,o],slide:function(e,t){s.val(t.values[0]),i.val(t.values[1])},stop:function(e,t){s.val(t.values[0]),i.val(t.values[1]),$(".fn_categories").append('<div class="fn_ajax_wait"></div>'),c()}}),a.on("change",function(){$("#fn_slider_price").slider("option","values",[s.val(),i.val()]),c()}),$(document).on("click",".fn_is_ajax a",function(e){e.preventDefault(),$(".fn_categories").append('<div class="fn_ajax_wait"></div>');var t=$(this).attr("href"),a=$("#fn_slider_min").val();send_max=$("#fn_slider_max").val(),$.ajax({url:t,data:{ajax:1,"p[min]":a,"p[max]":send_max},dataType:"json",success:function(e){$("#fn_products_content").html(e.products_content),$(".fn_pagination").html(e.products_pagination),$("#fn_products_sort").html(e.products_sort),$(".fn_ajax_wait").remove()}})})}$("#search input").autocomplete({serviceUrl:"ajax/search_products.php",minChars:1,noCache:!1,onSelect:function(){$("#search").submit()},formatResult:function(e,t){var a=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),s="("+t.replace(a,"\\$1")+")";return"<div>"+(e.data.image?"<img align=absmiddle src='"+e.data.image+"'> ":"")+"</div><a href="+e.lang+"products/"+e.data.url+">"+e.value.replace(new RegExp(s,"gi"),"<strong>$1</strong>")+"</a><span>"+e.price+" "+e.currency+"</span>"}}),$(".fn_comparison_products").size()&&($(".fn_comparison_products").slick({infinite:!1,slidesToShow:4,slidesToScroll:1,arrows:!0,responsive:[{breakpoint:1250,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:1e3,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:800,settings:{slidesToShow:1,slidesToScroll:1}}]}),resize_comparison(),$(".fancy_zoom").fancybox(),$(document).on("click",".fn_show a",function(e){e.preventDefault(),$(".fn_show a.active").removeClass("active"),$(this).addClass("active"),$(this).hasClass("unique")?$(".cell.not_unique").hide():$(".cell.not_unique").show()})),$(".product_rating").rater({postHref:"ajax/rating.php"}),$(document).on("click",'[name="payment_method_id"]',function(){$('[name="payment_method_id"]').parent().removeClass("active"),$(this).parent().addClass("active")})}),$(document).on("submit",".fn_variants",function(e){e.preventDefault();var t,a;$(this).find("input[name=variant]:checked").size()>0?t=$(this).find("input[name=variant]:checked").val():$(this).find("input[name=variant]").size()>0?t=$(this).find("input[name=variant]").val():$(this).find("select[name=variant]").size()>0&&(t=$(this).find("select[name=variant]").val()),a=$(this).find("input[name=amount]").size()>0?$(this).find("input[name=amount]").val():1,$.ajax({url:"ajax/cart.php",data:{variant:t,amount:a},dataType:"json",success:function(e){$("#cart_informer").html(e)}}),transfer($("#cart_informer"),$(this))}),$(document).on("change",".fn_variant",function(){var e=$(this).children(":selected"),t=e.closest(".fn_product"),a=t.find(".fn_price"),s=t.find(".fn_old_price"),i=t.find(".fn_sku"),n=parseInt(e.data("stock")),o=t.find('input[name="amount"]'),r=parseInt(o.val());a.html(e.data("price")),o.data("max",n),r>n?o.val(n):okay.amount>r?o.val(okay.amount):isNaN(r)&&o.val(okay.amount),e.data("cprice")?(s.html(e.data("cprice")),s.parent().removeClass("hidden")):s.parent().addClass("hidden"),"undefined"!=typeof e.data("sku")?(i.text(e.data("sku")),i.parent().removeClass("hidden")):(i.text(""),i.parent().addClass("hidden")),0==n?(t.find(".fn_not_stock").removeClass("hidden"),t.find(".fn_in_stock").addClass("hidden")):(t.find(".fn_in_stock").removeClass("hidden"),t.find(".fn_not_stock").addClass("hidden")),0==n&&okay.is_preorder?(t.find(".fn_is_preorder").removeClass("hidden"),t.find(".fn_is_stock, .fn_not_preorder").addClass("hidden")):0!=n||okay.is_preorder?(t.find(".fn_is_stock").removeClass("hidden"),t.find(".fn_is_preorder, .fn_not_preorder").addClass("hidden")):(t.find(".fn_not_preorder").removeClass("hidden"),t.find(".fn_is_stock, .fn_is_preorder").addClass("hidden"))}),$(document).on("click",".fn_product_amount span",function(){var e,t=$(this).parent().find("input");$(this).hasClass("plus")?e="plus":$(this).hasClass("minus")&&(e="minus"),amount_change(t,e)}),$(document).on("click",".fn_comparison",function(e){e.preventDefault();var t=$(this),a=$(this).hasClass("selected")?"delete":"add",s=parseInt($(this).data("id"));$.ajax({url:"ajax/comparison.php",data:{product:s,action:a},dataType:"json",success:function(e){if($("#comparison").html(e),"add"==a?t.addClass("selected"):"delete"==a&&t.removeClass("selected"),t.attr("title")){var s=t.data("result-text"),i=t.attr("title");t.data("result-text",i),t.attr("title",s)}$(".fn_comparison_products").size()&&(window.location=window.location)}}),t.hasClass("selected")||transfer($("#comparison"),$(this))}),$(document).on("click",".fn_wishlist",function(e){e.preventDefault();var t=$(this),a=$(this).hasClass("selected")?"delete":"";$.ajax({url:"ajax/wishlist.php",data:{id:$(this).data("id"),action:a},dataType:"json",success:function(e){if($("#wishlist").html(e.info),""==a?t.addClass("selected"):t.removeClass("selected"),t.attr("title")){var s=t.data("result-text"),i=t.attr("title");t.data("result-text",i),t.attr("title",s)}$(".fn_wishlist_page").size()&&(window.location=window.location)}}),t.hasClass("selected")||transfer($("#wishlist"),$(this))}),$(document).on("keypress",".fn_coupon",function(e){13==e.keyCode&&(e.preventDefault(),ajax_coupon())}),$(document).on("click",".fn_sub_coupon",function(){ajax_coupon()}),$(window).load(resize_comparison),$.fn.rater=function(e){var t=$.extend({},$.fn.rater.defaults,e);return this.each(function(){var e=$(this),a=e.find(".rating_starOn"),s=e.find(".rating_starOff");t.size=a.height(),void 0==t.rating&&(t.rating=a.width()/t.size),s.mousemove(function(e){var i=e.clientX-s.offset().left,n=s.width()-(s.width()-i);n=Math.ceil(n/(t.size/t.step))*t.size/t.step,a.width(n)}).hover(function(){a.addClass("rating_starHover")},function(){a.removeClass("rating_starHover"),a.width(t.rating*t.size)}).click(function(){var i=Math.round(a.width()/s.width()*t.units*t.step)/t.step;s.unbind("click").unbind("mousemove").unbind("mouseenter").unbind("mouseleave"),s.css("cursor","default"),a.css("cursor","default"),t.id=e.attr("id"),$.fn.rater.rate(e,t,i)}).css("cursor","pointer"),a.css("cursor","pointer")})},$.fn.rater.defaults={postHref:location.href,units:5,step:1},$.fn.rater.rate=function(e,t,a){var s=e.find(".rating_starOn"),i=e.find(".rating_starOff");i.fadeTo(600,.4,function(){$.ajax({url:t.postHref,type:"POST",data:"id="+t.id+"&rating="+a,complete:function(a){200==a.status?(t.rating=parseFloat(a.responseText),t.rating>0?(t.rating=parseFloat(a.responseText),i.fadeTo(200,.1,function(){s.removeClass("rating_starHover").width(t.rating*t.size);var a=e.find(".rating_count");a.text(parseInt(a.text())+1),e.find(".rating_value").text(t.rating.toFixed(1)),i.fadeTo(200,1)})):-1==t.rating?i.fadeTo(200,.6,function(){e.find(".rating_text").text("Ошибка")}):i.fadeTo(200,.6,function(){e.find(".rating_text").text("Вы уже голосовали!")})):(alert(a.responseText),s.removeClass("rating_starHover").width(t.rating*t.size),e.rater(t),i.fadeTo(2200,1))}})})};